<!DOCTYPE html>
<html lang="en">
<head>
  <title>Github pages + Org mode - Pinvon&#39;s Blog</title>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
  <meta name="author" content="Pinvon" />
  <meta name="description" content="&lt;TODO: insert your description here&gt;" />
  <meta name="keywords" content="org page" />
  <style>
   #ds-thread #ds-reset .ds-comment-body p {color: #ffffff;}
   #ds-thread #ds-reset .ds-comment-body p a {color: #ff0;}
   #ds-thread #ds-reset .ds-comment-body p a:hover {color: #0ff;}
   #disqus_thread a {color: #00ffff;}
  </style>
  <link rel="stylesheet" href="http://pinvondev.github.io/media/css/main.css" type="text/css"/>
  <link rel="stylesheet" href="http://pinvondev.github.io/media/css/comment.css" type="text/css"/>
</head>

  <body><div class="container">
<div>
  <header class="masthead">
    <h1 class="masthead-title"><a href="http://pinvondev.github.io/">Pinvon&#39;s Blog</a></h1>
    <p>所见, 所闻, 所思, 所想</p>
    <nav class="site-nav">
      <div class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z" fill="#ffff00"/>
          <path d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z" fill="#ffff00"/>
          <path d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z" fill="#ffff00"/>
        </svg>
      </div>
      <ul class="trigger">
        <li><a href="http://pinvondev.github.io/years/">Years</a></li>
        <li><a href="http://pinvondev.github.io/authors/">Authors</a></li>
        <li><a href="http://pinvondev.github.io/tags/">Tags</a></li>
        <li><a href="http://pinvondev.github.io/about/">About</a></li>
        <li><a href="https://github.com/pinvondev">Github</a></li>
        <li><a href="http://pinvondev.github.io/rss.xml">RSS</a></li>
      </ul>
    </nav>
    <form method="get" id="searchform" action="http://www.google.com/search">
      <input type="text" class="field" name="q" id="s" placeholder="Search">
      <input type="hidden" name="as_sitesearch" value="pinvondev.github.io">
    </form>
  </header>
</div>

<div>
<div class="post">
<h1 class="title">Github pages + Org mode</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgcc81457">Org-Page</a>
<ul>
<li><a href="#orgdaa4e8b">介绍</a></li>
<li><a href="#org2782659">工作流程</a></li>
<li><a href="#org7e56cc7">用法</a>
<ul>
<li><a href="#org3b4b32b">安装</a></li>
<li><a href="#org9a582c5">配置</a></li>
<li><a href="#orgbaac616">发布</a></li>
<li><a href="#orgf54a1cf">预览</a></li>
</ul>
</li>
<li><a href="#org6504e75">注意点</a>
<ul>
<li><a href="#orgf87eac7">无法上传的情况</a></li>
</ul>
</li>
<li><a href="#org100ffc7">定制</a>
<ul>
<li><a href="#org807d7bf">生成页面目录</a></li>
<li><a href="#org67d822a">图片大小调整</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org2f2a07f">EGO</a>
<ul>
<li><a href="#org4e29b37">概述</a></li>
<li><a href="#org9f8c06b">安装</a></li>
<li><a href="#orgf7640dc">设置</a></li>
<li><a href="#org7e0b391">新建文章</a></li>
<li><a href="#orgf9bbe34">测试单独文章的 html 页面</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgcc81457" class="outline-2">
<h2 id="orgcc81457">Org-Page</h2>
<div class="outline-text-2" id="text-orgcc81457">
</div>
<div id="outline-container-orgdaa4e8b" class="outline-3">
<h3 id="orgdaa4e8b">介绍</h3>
<div class="outline-text-3" id="text-orgdaa4e8b">
<p>
org-page是一个基于org-mode的静态网站生成器。提供了以下功能：
</p>

<ul class="org-ul">
<li>使用git管理org文件和html文件</li>
<li>可多次编辑</li>
<li>支持分类</li>
<li>支持标签</li>
<li>支持RSS</li>
<li>支持搜索</li>
<li>定制主题</li>
<li>可评论</li>
<li>网站流量统计</li>
<li>网站预览</li>
<li>高度定制</li>
</ul>
</div>
</div>

<div id="outline-container-org2782659" class="outline-3">
<h3 id="org2782659">工作流程</h3>
<div class="outline-text-3" id="text-org2782659">
<ul class="org-ul">
<li>指定一个git仓库，用source分支管理org文件，用master分支管理html文件。仓库可以手动创建，也可以使用org-page的 <b>op/new-repository</b> 命令创建。</li>
<li>指定一个基本的提交，默认是最近一次提交。org-page将从source分支读取最近的改变，并标记它们，用于发布文章。</li>
<li>准备工作。</li>
<li>发布改变的内容。由于删除文章这种操作不常有，所以org-page不支持。</li>
<li>更新所有的分类和标签。</li>
</ul>
</div>
</div>

<div id="outline-container-org7e56cc7" class="outline-3">
<h3 id="org7e56cc7">用法</h3>
<div class="outline-text-3" id="text-org7e56cc7">
<p>
在doc/quick-guide.org中有详细用法。
</p>
</div>

<div id="outline-container-org3b4b32b" class="outline-4">
<h4 id="org3b4b32b">安装</h4>
<div class="outline-text-4" id="text-org3b4b32b">
<p>
从melpa上安装org-page
</p>
</div>
</div>

<div id="outline-container-org9a582c5" class="outline-4">
<h4 id="org9a582c5">配置</h4>
<div class="outline-text-4" id="text-org9a582c5">
<p>
如果手动安装，则将配置信息放在.emacs文件中。
</p>

<pre class="example">
(require 'org-page)
(setq op/repository-directory "~/Blog")
(setq op/site-domain "http://pinvondev.github.io/")
;;; for commenting, you can choose either disqus, duoshuo or hashover
;;; (setq op/personal-disqus-shortname "your_disqus_shortname")
;;; (setq op/personal-duoshuo-shortname "your_duoshuo_shortname")
(setq op/hashover-comments t)
;;; the configuration below are optional
;;; (setq op/personal-google-analytics-id "your_google_analytics_id")
(setq op/personal-github-link "https://github.com/pinvondev")
(setq op/site-main-title "Pinvon's Blog")
</pre>

<p>
使用 <b>op/new-repository</b> 指定配置中的文件夹为本地仓库。
</p>

<p>
使用 <b>op/new-post</b> 写文章。
</p>

<p>
在发布文章之前，先为本地仓库关联远程仓库。
</p>

<pre class="example">
git remote add origin git@pinvondev.github.com/pinvondev/pinvondev.github.io.git
</pre>
</div>
</div>

<div id="outline-container-orgbaac616" class="outline-4">
<h4 id="orgbaac616">发布</h4>
<div class="outline-text-4" id="text-orgbaac616">
<p>
执行以下代码：
</p>
<pre class="example">
(op/do-publication nil "HEAD^1" "~/org-pub/" nil)
</pre>

<p>
或
</p>

<pre class="example">
(op/do-publication)
</pre>

<p>
或
</p>

<p>
<b>M-x op/do-publication &lt;Enter&gt;</b> 但是这样做之前，需要把org文件上传到github。
</p>
</div>
</div>



<div id="outline-container-orgf54a1cf" class="outline-4">
<h4 id="orgf54a1cf">预览</h4>
<div class="outline-text-4" id="text-orgf54a1cf">
<p>
<b>M-x op/do-publication-and-preview-site &lt;Enter&gt;</b> ，网站将在 <b>~/.op-tmp</b> 中发布。
</p>
</div>
</div>
</div>

<div id="outline-container-org6504e75" class="outline-3">
<h3 id="org6504e75">注意点</h3>
<div class="outline-text-3" id="text-org6504e75">
<ul class="org-ul">
<li>切换到source分支，编辑.org文件，上传到github。</li>
<li>然后op/do-publication，op/do-publication会自动切换到master分支。</li>
<li>如果没有上传html文件到github，则手动上传。</li>
</ul>
</div>

<div id="outline-container-orgf87eac7" class="outline-4">
<h4 id="orgf87eac7">无法上传的情况</h4>
<div class="outline-text-4" id="text-orgf87eac7">
<p>
在正确配置git的情况下，如果source分支已上传，而op/do-publication时没上传成功，则将仓库根目录下 <code>.git</code> 里面的所有文件都赋给当前用户所有操作权限。
</p>
<pre class="example">
sudo chown -R pinvon:pinvon ./.git
cd .git
sudo chown -R pingon:pinvon *
</pre>
</div>
</div>
</div>

<div id="outline-container-org100ffc7" class="outline-3">
<h3 id="org100ffc7">定制</h3>
<div class="outline-text-3" id="text-org100ffc7">
</div>
<div id="outline-container-org807d7bf" class="outline-4">
<h4 id="org807d7bf">生成页面目录</h4>
<div class="outline-text-4" id="text-org807d7bf">
<pre class="example">
#+OPTIONS:     H:3 num:nil toc:nil \n:nil ::t |:t ^:nil -:nil f:t *:t &lt;:t
;;; 将toc后的nil改成t即可
</pre>
</div>
</div>


<div id="outline-container-org67d822a" class="outline-4">
<h4 id="org67d822a">图片大小调整</h4>
<div class="outline-text-4" id="text-org67d822a">
<ol class="org-ol">
<li>将org-mode中设置的显示原图大小取消。</li>
</ol>
<pre class="example">
(setq org-image-actual-width nil)
</pre>
<ol class="org-ol">
<li>在org-mode中，自己填入属性值。</li>
</ol>
<pre class="example">
#+CAPTION: 图片标题
#+ATTR_HTML: :width 100
#+ATTR_LATEX: :width 100in
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org2f2a07f" class="outline-2">
<h2 id="org2f2a07f">EGO</h2>
<div class="outline-text-2" id="text-org2f2a07f">
</div>
<div id="outline-container-org4e29b37" class="outline-3">
<h3 id="org4e29b37">概述</h3>
<div class="outline-text-3" id="text-org4e29b37">
<p>
EGO 是由 org-page 和 org-webpage 派生出来的项目.
</p>

<p>
我从 org-page 转向 EGO, 主要是在使用 org-page 的过程中, 出现了一些 bug, 而这些 bug, 由于不熟悉 Elisp, 我无法修复. 也许等什么时候有时间了, 再好好学一下 Elisp, 才能把这些问题修复. 最常碰到的 bug 是, source 分支已经提交了文件, 而使用 op/do-publication 时, master 分支有时可以正常提交, 有时不能正常提交.
</p>

<p>
另外, 我希望调整博客显示的宽度, 但是改了 css 文件之后, 发现下次又被还原了.
</p>

<p>
最重要的一点是, org-page 长时间没更新了.
</p>
</div>
</div>

<div id="outline-container-org9f8c06b" class="outline-3">
<h3 id="org9f8c06b">安装</h3>
<div class="outline-text-3" id="text-org9f8c06b">
<p>
从 melpa 安装.
</p>

<p>
从 github 安装. git clone <a href="https://github.com/emacs-china/EGO.git">https://github.com/emacs-china/EGO.git</a>
</p>
</div>
</div>

<div id="outline-container-orgf7640dc" class="outline-3">
<h3 id="orgf7640dc">设置</h3>
<div class="outline-text-3" id="text-orgf7640dc">
<p>
参考配置:
</p>

<div class="org-src-container">
<pre class="src src-Elisp">;; the following is only needed if you install EGO manually
(add-to-list 'load-path "path/to/EGO")

(require 'ego)

(ego-add-to-alist 'ego-project-config-alist
               `(("emacs-china" ; 站点工程的名字
                 :repository-directory "~/github/emacs-china.github.io" ; 站点的本地目录
                 :site-domain "http://emacs-china.github.io/" ; 站点的网址
                 :site-main-title "EMACS-CHINA" ; 站点的标题
                 :site-sub-title "=============&gt;集思广益" ; 站点的副标题
                 :theme (default) ; 使用的主题
                 :summary (("years" :year :updates 10) ("authors" :authors) ("tags" :tags)) ; 导航栏的设置，有 category 和 summary 两种
                 :source-browse-url ("Github" "https://github.com/emacs-china") ; 你的工程源代码所在的位置
                 :personal-disqus-shortname "emacs-china" ; 使用 disqus 评论功能的话，它的短名称
                 ;; :personal-duoshuo-shortname "emacs-china" ; 使用 多说 评论功能的话，它的短名称(由于多说已经关闭，这里就此废置)
                 :confound-email nil ; 是否保护邮件名称呢？t 是保护，nil 是不保护，默认是保护
                 :ignore-file-name-regexp "readme.org" ; 有些不想发布成 html 的 org 文件（但是又想被导入 git 进行管理），可以用这种正则表达的方式排除
                 :web-server-docroot "~/webRoot/emacs-china.github.io" ; 本地测试的目录
                 :web-server-port 5432); 本地测试的端口

                 ;; 你可以在此添加更多的站点设置
               ))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7e0b391" class="outline-3">
<h3 id="org7e0b391">新建文章</h3>
<div class="outline-text-3" id="text-org7e0b391">
<p>
M-x ego-new-post
</p>
</div>
</div>

<div id="outline-container-orgf9bbe34" class="outline-3">
<h3 id="orgf9bbe34">测试单独文章的 html 页面</h3>
<div class="outline-text-3" id="text-orgf9bbe34">
<p>
M-x ego-test-current-page
</p>
</div>
</div>
</div>

</div>
</div>
<div>
        <div class="post-meta">
            <span title="post date" class="post-info">2017-12-29</span>
            <span title="last modification date" class="post-info">2018-04-21</span>
            <span title="tags" class="post-info">:<a href="http://pinvondev.github.io/tags/org-page">org page</a>:</span>
            <span title="author" class="post-info"><a href="mailto:pinvon@Inspiron">Pinvon</a></span>
        </div>
    <script src="http://pinvondev.github.io/media/js/jquery-2.1.3.min.js"></script>
        <section>
            <h1>Comments</h1>
            <div id="comment-wrap">
                    <a class="disqus_label">使用 Disqus 评论</a>
    </ul>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
         //var disqus_developer = 1;
         var preempt_signal=false;
         var disqus_identifier = "/blog/2017/12/29/github-pages-+-org-mode";
         var disqus_url = "http://pinvondev.github.io/blog/2017/12/29/github-pages-+-org-mode";
         var disqus_shortname = 'pinvon';
         /* * * DON'T EDIT BELOW THIS LINE * * */
         (function() {
             var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
             dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
             (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
             $('#disqus_thread').css('display','none');
         })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    <script>
     /* comments */
     var ego_disqus_thread=$('#disqus_thread');
     var ego_ds_label=$('.ds-thread');
     $('.disqus_label').click(function(){
         ego_disqus_thread.show();
         ego_ds_label.hide();
     });
     $('.ds-label').click(function(){
         ego_disqus_thread.hide();
         ego_ds_label.show();
     });
    </script>
        </section>
    <script src="http://pinvondev.github.io/media/js/main.js"></script>
    <div class="footer">
        <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.x(<a href="http://orgmode.org">Org mode</a> 9.x)</p>
        <p>
            Copyright &copy; 2014 - <span id="footerYear"></span> <a href="mailto:pinvon@Inspiron">Pinvon</a>
            &nbsp;&nbsp;-&nbsp;&nbsp;
            Powered by <a href="https://github.com/emacs-china/ego" target="_blank">EGO</a><br/>
            <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license"><img src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" style="border-width:0" alt="Creative Commons License" class="center"></a>
            <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
        </p>
    </div>
            </div>
            <script type="text/javascript"
                    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG">
            </script>
            <script type="text/x-mathjax-config">
             MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });
            </script>
</div>

  </div></body>
</html>
