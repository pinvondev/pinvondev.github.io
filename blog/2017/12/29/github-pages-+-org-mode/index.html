<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>Github pages + Org mode - Pinvon&#39;s Blog</title>
    <meta charset="utf-8" />
    <meta name="author" content="Pinvon" />
    <meta name="description" content="&lt;TODO: insert your description here&gt;" />
    <meta name="keywords" content="&lt;TODO: insert your keywords here&gt;" />
    <link rel="stylesheet" href="/media/css/main.css" type="text/css">
  </head>
  <body class="container">
    <div>
      <header class="masthead">
        <h1 class="masthead-title"><a href="/">Pinvon&#39;s Blog</a></h1>
        <p>所见，所闻，所思，所想</p>
        <ul>
          <li><a href="/blog/">Blog</a></li>
          <li><a href="/tags/">Tags</a></li>
          <li><a href="/about/">About</a></li>
          <li><a href="https://github.com/pinvondev">GitHub</a></li>
        </ul>
        <form method="get" id="searchform" action="http://www.google.com/search">
          <input type="text" class="field" name="q" id="s" placeholder="Search">
          <input type="hidden" name="q" value="site:pinvondev.github.io">
        </form>
      </header>
    </div>

<div>
<div class="post">
<h1>Github pages + Org mode</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org49408a2">介绍</a></li>
<li><a href="#orgdee31ba">工作流程</a></li>
<li><a href="#org665eb27">用法</a>
<ul>
<li><a href="#orgb2bfe04">安装</a></li>
<li><a href="#orgef58ca7">配置</a></li>
<li><a href="#orgcb95e76">发布</a></li>
<li><a href="#org16ca3dd">预览</a></li>
</ul>
</li>
<li><a href="#org8a0422e">注意点</a>
<ul>
<li><a href="#orgfa4c739">无法上传的情况</a></li>
</ul>
</li>
<li><a href="#orgdc970fa">定制</a>
<ul>
<li><a href="#org9fddbbb">生成页面目录</a></li>
<li><a href="#org9c4df0a">图片大小调整</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org49408a2" class="outline-2">
<h2 id="org49408a2">介绍</h2>
<div class="outline-text-2" id="text-org49408a2">
<p>
org-page是一个基于org-mode的静态网站生成器。提供了以下功能：
</p>

<ul class="org-ul">
<li>使用git管理org文件和html文件</li>
<li>可多次编辑</li>
<li>支持分类</li>
<li>支持标签</li>
<li>支持RSS</li>
<li>支持搜索</li>
<li>定制主题</li>
<li>可评论</li>
<li>网站流量统计</li>
<li>网站预览</li>
<li>高度定制</li>
</ul>
</div>
</div>

<div id="outline-container-orgdee31ba" class="outline-2">
<h2 id="orgdee31ba">工作流程</h2>
<div class="outline-text-2" id="text-orgdee31ba">
<ul class="org-ul">
<li>指定一个git仓库，用source分支管理org文件，用master分支管理html文件。仓库可以手动创建，也可以使用org-page的 <b>op/new-repository</b> 命令创建。</li>
<li>指定一个基本的提交，默认是最近一次提交。org-page将从source分支读取最近的改变，并标记它们，用于发布文章。</li>
<li>准备工作。</li>
<li>发布改变的内容。由于删除文章这种操作不常有，所以org-page不支持。</li>
<li>更新所有的分类和标签。</li>
</ul>
</div>
</div>

<div id="outline-container-org665eb27" class="outline-2">
<h2 id="org665eb27">用法</h2>
<div class="outline-text-2" id="text-org665eb27">
<p>
在doc/quick-guide.org中有详细用法。
</p>
</div>

<div id="outline-container-orgb2bfe04" class="outline-3">
<h3 id="orgb2bfe04">安装</h3>
<div class="outline-text-3" id="text-orgb2bfe04">
<p>
从melpa上安装org-page
</p>
</div>
</div>

<div id="outline-container-orgef58ca7" class="outline-3">
<h3 id="orgef58ca7">配置</h3>
<div class="outline-text-3" id="text-orgef58ca7">
<p>
如果手动安装，则将配置信息放在.emacs文件中。
</p>

<pre class="example">
(require 'org-page)
(setq op/repository-directory "~/Blog")
(setq op/site-domain "http://pinvondev.github.io/")
;;; for commenting, you can choose either disqus, duoshuo or hashover
;;; (setq op/personal-disqus-shortname "your_disqus_shortname")
;;; (setq op/personal-duoshuo-shortname "your_duoshuo_shortname")
(setq op/hashover-comments t)
;;; the configuration below are optional
;;; (setq op/personal-google-analytics-id "your_google_analytics_id")
(setq op/personal-github-link "https://github.com/pinvondev")
(setq op/site-main-title "Pinvon's Blog")
</pre>

<p>
使用 <b>op/new-repository</b> 指定配置中的文件夹为本地仓库。
</p>

<p>
使用 <b>op/new-post</b> 写文章。
</p>

<p>
在发布文章之前，先为本地仓库关联远程仓库。
</p>

<pre class="example">
git remote add origin git@pinvondev.github.com/pinvondev/pinvondev.github.io.git
</pre>
</div>
</div>

<div id="outline-container-orgcb95e76" class="outline-3">
<h3 id="orgcb95e76">发布</h3>
<div class="outline-text-3" id="text-orgcb95e76">
<p>
执行以下代码：
</p>
<pre class="example">
(op/do-publication nil "HEAD^1" "~/org-pub/" nil)
</pre>

<p>
或
</p>

<pre class="example">
(op/do-publication)
</pre>

<p>
或
</p>

<p>
<b>M-x op/do-publication &lt;Enter&gt;</b> 但是这样做之前，需要把org文件上传到github。
</p>
</div>
</div>



<div id="outline-container-org16ca3dd" class="outline-3">
<h3 id="org16ca3dd">预览</h3>
<div class="outline-text-3" id="text-org16ca3dd">
<p>
<b>M-x op/do-publication-and-preview-site &lt;Enter&gt;</b> ，网站将在 <b>~/.op-tmp</b> 中发布。
</p>
</div>
</div>
</div>

<div id="outline-container-org8a0422e" class="outline-2">
<h2 id="org8a0422e">注意点</h2>
<div class="outline-text-2" id="text-org8a0422e">
<ul class="org-ul">
<li>切换到source分支，编辑.org文件，上传到github。</li>
<li>然后op/do-publication，op/do-publication会自动切换到master分支。</li>
<li>如果没有上传html文件到github，则手动上传。</li>
</ul>
</div>

<div id="outline-container-orgfa4c739" class="outline-3">
<h3 id="orgfa4c739">无法上传的情况</h3>
<div class="outline-text-3" id="text-orgfa4c739">
<p>
在正确配置git的情况下，如果source分支已上传，而op/do-publication时没上传成功，则将仓库根目录下 <code>.git</code> 里面的所有文件都赋给当前用户所有操作权限。
</p>
<pre class="example">
sudo chown -R pinvon:pinvon ./.git
cd .git
sudo chown -R pingon:pinvon *
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdc970fa" class="outline-2">
<h2 id="orgdc970fa">定制</h2>
<div class="outline-text-2" id="text-orgdc970fa">
</div>
<div id="outline-container-org9fddbbb" class="outline-3">
<h3 id="org9fddbbb">生成页面目录</h3>
<div class="outline-text-3" id="text-org9fddbbb">
<pre class="example">
#+OPTIONS:     H:3 num:nil toc:nil \n:nil ::t |:t ^:nil -:nil f:t *:t &lt;:t
;;; 将toc后的nil改成t即可
</pre>
</div>
</div>


<div id="outline-container-org9c4df0a" class="outline-3">
<h3 id="org9c4df0a">图片大小调整</h3>
<div class="outline-text-3" id="text-org9c4df0a">
<ol class="org-ol">
<li>将org-mode中设置的显示原图大小取消。</li>
</ol>
<pre class="example">
(setq org-image-actual-width nil)
</pre>
<ol class="org-ol">
<li>在org-mode中，自己填入属性值。</li>
</ol>
<pre class="example">
#+CAPTION: 图片标题
#+ATTR_HTML: :width 100
#+ATTR_LATEX: :width 100in
</pre>
</div>
</div>
</div>

</div>
</div>
    <div>
      <div class="post-meta">
        <span title="post date" class="post-info">2017-12-29</span>
        <span title="last modification date" class="post-info">2018-01-01</span>
        <span title="tags" class="post-info"><a href="/tags/org-page/">org page</a></span>
        <span title="author" class="post-info">Pinvon</span>
      </div>
      <section>
        <h1>Comments</h1>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          //var disqus_developer = 1;
          var disqus_identifier = "/blog/2017/12/29/github-pages-+-org-mode";
          var disqus_url = "http://pinvondev.github.io/blog/2017/12/29/github-pages-+-org-mode";
          var disqus_shortname = 'pinvon';
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </section>
      <div class="footer">
        <p>Generated by <a href="https://www.gnu.org/software/emacs/">Emacs</a> 25.3.50.2 (<a href="http://orgmode.org">Org</a> mode 9.1.5)</p>
        <p>
          Copyright &copy; 2012 - 2013 <a href="mailto:pinvon &lt;at&gt; Inspiron">Pinvon</a>
          &nbsp;&nbsp;-&nbsp;&nbsp;
          Powered by <a href="https://github.com/kelvinh/org-page" target="_blank">org-page</a>
        </p>
      </div>
    </div>
  </body>
</html>
